<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Configuración básica de la página -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mejoras en GamesCow</title>
    
    <!-- Carga de la librería Chart.js para dibujar el gráfico de radar en los resultados -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- 1. Importar Google Fonts: Inter para texto general y Montserrat para títulos -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Montserrat:wght@700;800;900&display=swap');
    </style>

    <!-- 2. Configurar Tailwind CSS y cargar el CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#3b82f6', // Color principal para elementos interactivos
                        'hover-shadow-gray': '#d1d5db', // Tono para sombra al pasar el mouse
                        'base-shadow-gray': '#e5e7eb',  // Tono base para sombra
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], // Fuente base
                        title: ['Montserrat', 'sans-serif'], // Fuente para encabezados
                    },
                    // Utilidades de sombreado personalizado para crear un efecto 3D/press en los botones de puntuación
                    boxShadow: {
                        'score-base': '0 4px var(--tw-shadow-color)',
                        'score-hover': '0 6px var(--tw-shadow-color)',
                        'score-active': '0 1px var(--tw-shadow-color)',
                    }
                }
            }
        }
    </script>
    
    <!-- CSS Personalizado para el Fondo de Videojuegos (Patrón Vibrante/Ciberpunk) -->
    <style>
        /* La clase 'vibrant-game-bg' aplica un patrón de cuadrícula neón sobre un fondo oscuro para un aspecto de videojuegos moderno y llamativo (Cyberpunk/HUD) */
        .vibrant-game-bg {
            /* Fondo base oscuro para un aspecto moderno y de alto contraste */
            background-color: #0e1428; 
            /* Patrón de líneas cruzadas finas y sutiles en color neón/cian */
            background-image: 
                repeating-linear-gradient(0deg, rgba(0, 255, 255, 0.08) 0, rgba(0, 255, 255, 0.08) 1px, transparent 1px, transparent 40px),
                repeating-linear-gradient(90deg, rgba(0, 255, 255, 0.08) 0, rgba(0, 255, 255, 0.08) 1px, transparent 1px, transparent 40px);
            background-size: 40px 40px;
        }
    </style>
</head>
<!-- Cuerpo principal de la aplicación. Mantengo un degradado neutro en el body para el área fuera de la aplicación principal. -->
<body class="p-4 md:p-8 font-sans bg-gradient-to-br from-gray-900 to-gray-800">

    <!-- Contenedor para mostrar la hora en tiempo real -->
    <div id="clock-container" class="text-center mb-6 pt-6">
        <!-- El reloj ahora es blanco para contrastar con el fondo oscuro del body -->
        <div id="real-time-clock" class="inline-block px-4 py-2 bg-gray-900 rounded-full shadow-xl text-xl font-bold text-cyan-400 tracking-wider border border-cyan-500/30">
            <!-- El contenido del reloj se actualiza vía JavaScript -->
        </div>
    </div>

    <!-- Contenedor principal de la aplicación. Aquí se carga dinámicamente cada pantalla (diapositiva) -->
    <div id="app-container" class="max-w-[900px] min-h-[85vh] mx-auto mb-10 rounded-2xl shadow-2xl shadow-indigo-500/30 flex flex-col justify-center overflow-hidden">
        <!-- Contenido dinámico (Bienvenida, Quiz o Resultados) se inserta aquí -->
    </div>

    <!-- Pie de página informativo -->
    <footer class="text-center text-gray-400 text-sm mt-8">
        Herramienta de Desarrollo de Competencias | Diseñada para la Autoevaluación y el Crecimiento.
    </footer>

    <script>
        // ======================================================================
        // --- CONFIGURACIÓN DE DATOS (COMPETENCIAS Y PREGUNTAS) ---
        // ======================================================================

        // Definición de las 4 competencias clave con sus IDs, nombres y colores para el gráfico
        const COMPETENCIES = [
            { id: 'comunicacion', name: 'Comunicación Efectiva', color: 'rgba(59, 130, 246, 0.8)', borderColor: '#3b82f6' }, // Azul
            { id: 'problemas', name: 'Resolución de Problemas', color: 'rgba(234, 179, 8, 0.8)', borderColor: '#eab308' }, // Amarillo
            { id: 'tiempo', name: 'Gestión del Tiempo', color: 'rgba(16, 185, 129, 0.8)', borderColor: '#10b981' }, // Verde
            { id: 'liderazgo', name: 'Liderazgo e Iniciativa', color: 'rgba(139, 92, 246, 0.8)', borderColor: '#8b5cf6' }, // Púrpura
        ];

        // Definición de las preguntas. Cada pregunta está asociada a una categoría (competencia)
        const QUESTIONS = [
            // Comunicación Efectiva
            { text: 'Yo explico mis ideas de forma clara y concisa en reuniones y documentos.', category: 'comunicacion' },
            { text: 'Escucho activamente a mis compañeros y hago preguntas para asegurar el entendimiento mutuo.', category: 'comunicacion' },
            { text: 'Adapto mi estilo de comunicación al público, ya sea formal o informal.', category: 'comunicacion' },
            { text: 'Doy y recibo retroalimentación de manera constructiva y profesional.', category: 'comunicacion' },

            // Resolución de Problemas
            { text: 'Cuando surge un problema, analizo la causa raíz antes de proponer soluciones.', category: 'problemas' },
            { text: 'Busco activamente información y recursos para resolver retos complejos.', category: 'problemas' },
            { text: 'Soy capaz de generar múltiples opciones de solución antes de elegir la mejor.', category: 'problemas' },
            { text: 'Mantengo la calma y el foco al enfrentar situaciones de alta presión o incertidumbre.', category: 'problemas' },

            // Gestión del Tiempo
            { text: 'Planifico mis tareas diarias y semanales, priorizando lo más importante.', category: 'tiempo' },
            { text: 'Evito la procrastinación y cumplo con mis fechas límite de manera consistente.', category: 'tiempo' },
            { text: 'Sé decir "no" a peticiones que desvían mi enfoque de los objetivos principales.', category: 'tiempo' },
            { text: 'Reviso mis métodos de trabajo con regularidad para ser más eficiente.', category: 'tiempo' },

            // Liderazgo e Iniciativa
            { text: 'Tomo la iniciativa para empezar nuevos proyectos o mejorar procesos sin que me lo pidan.', category: 'liderazgo' },
            { text: 'Motivo y apoyo a mis compañeros para alcanzar los objetivos del equipo.', category: 'liderazgo' },
            { text: 'Asumo la responsabilidad de mis errores y aprendo de ellos rápidamente.', category: 'liderazgo' },
            { text: 'Propongo ideas innovadoras y estoy dispuesto(a) a tomar riesgos calculados.', category: 'liderazgo' },
        ];

        // ======================================================================
        // --- ESTADO Y UTILERÍAS GLOBALES ---
        // ======================================================================

        let currentQuestionIndex = 0; // Índice de la pregunta actual
        let answers = new Array(QUESTIONS.length).fill(0); // Array para guardar las respuestas (0 = sin respuesta)
        const appContainer = document.getElementById('app-container'); // Referencia al contenedor principal

        // --- LÓGICA DEL RELOJ ---
        // Función para actualizar la hora actual en el encabezado
        function updateClock() {
            const now = new Date();
            // Formatear la hora en formato local (HH:MM:SS)
            const options = {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            };
            const timeString = now.toLocaleTimeString('es-ES', options);

            const clockElement = document.getElementById('real-time-clock');
            if (clockElement) {
                clockElement.textContent = `Hora Actual: ${timeString}`;
            }
        }

        // ======================================================================
        // --- FUNCIONES DE RENDERIZADO DE PANTALLAS (DIAPOSITIVAS) ---
        // ======================================================================

        // RENDERIZA la pantalla de bienvenida
        function renderWelcomeScreen() {
            appContainer.innerHTML = `
                <!-- Aplicando la clase 'vibrant-game-bg' para el fondo llamativo -->
                <div class="text-center p-8 md:p-12 h-full rounded-2xl vibrant-game-bg">
                    <!-- Títulos en cian neón para alto contraste -->
                    <h1 class="text-5xl font-extrabold font-title text-cyan-400 mb-4 drop-shadow-[0_0_5px_rgba(0,255,255,0.7)]">
                        Mejoras en GamesCow
                    </h1>
                    <p class="text-xl text-gray-300 mb-8">
                        Responde esta serie de preguntas para identificar tus áreas de dominio y oportunidades de crecimiento en competencias clave.
                    </p>
                    <!-- Bloque de instrucciones destacado, manteniendo un fondo claro para legibilidad -->
                    <div class="p-6 bg-white border-l-4 border-blue-500 text-left text-blue-800 rounded-lg inline-block max-w-lg mx-auto shadow-md">
                        <p class="font-semibold mb-2">Instrucciones:</p>
                        <ul class="list-disc list-inside text-sm">
                            <li>Elige una puntuación del 1 (Totalmente en desacuerdo) al 5 (Totalmente de acuerdo) para cada afirmación.</li>
                            <li>Las respuestas son confidenciales y están diseñadas para la autoevaluación.</li>
                            <li>Tiempo estimado: 5 minutos.</li>
                        </ul>
                    </div>
                    <!-- Botón para iniciar el quiz -->
                    <button onclick="startQuiz()" class="mt-10 px-8 py-3 bg-indigo-600 text-white text-lg font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-[1.01]">
                        Comenzar Autoevaluación
                    </button>
                </div>
            `;
        }

        // Inicia el quiz reseteando el estado y renderizando la primera pregunta
        function startQuiz() {
            currentQuestionIndex = 0;
            answers = new Array(QUESTIONS.length).fill(0);
            renderQuizScreen();
        }

        // RENDERIZA la pantalla de la pregunta actual
        function renderQuizScreen() {
            // Si ya se respondieron todas las preguntas, pasa a la pantalla de resultados
            if (currentQuestionIndex >= QUESTIONS.length) {
                return renderResultsScreen();
            }

            const question = QUESTIONS[currentQuestionIndex];
            const currentCompetency = COMPETENCIES.find(c => c.id === question.category).name;
            const progress = (currentQuestionIndex / QUESTIONS.length) * 100;

            // Genera dinámicamente los botones de puntuación (1 al 5)
            const buttonsHtml = [1, 2, 3, 4, 5].map(score => {
                // Clases de base para los botones de puntuación
                const baseClasses = "w-12 h-12 text-lg font-bold rounded-full border border-gray-300 flex items-center justify-center transition-all duration-100 ease-out cursor-pointer";
                const shadowClasses = `shadow-score-base shadow-base-shadow-gray hover:-translate-y-0.5 hover:shadow-score-hover hover:shadow-hover-shadow-gray active:scale-95 active:shadow-score-active active:shadow-hover-shadow-gray`;
                
                // Clases para indicar si el botón ha sido seleccionado
                const selectedClasses = 'bg-primary-blue text-white translate-y-0 shadow-md shadow-blue-700/50';
                const unselectedClasses = 'bg-white text-gray-700 hover:bg-gray-100';

                const stateClasses = answers[currentQuestionIndex] === score ? selectedClasses : unselectedClasses;

                return `
                    <button
                        class="${baseClasses} ${shadowClasses} ${stateClasses}"
                        onclick="selectAnswer(${score})"
                        aria-label="Puntuación ${score}"
                    >
                        ${score}
                    </button>
                `;
            }).join('');

            appContainer.innerHTML = `
                <!-- Aplicando la clase 'vibrant-game-bg' para el fondo llamativo -->
                <div class="p-4 md:p-8 h-full rounded-2xl vibrant-game-bg">
                    <!-- Barra de Progreso: Texto claro para el fondo oscuro -->
                    <div class="mb-8">
                        <p class="text-sm text-gray-300 mb-2">Pregunta ${currentQuestionIndex + 1} de ${QUESTIONS.length}</p>
                        <div class="w-full bg-gray-700 rounded-full h-2.5 border border-cyan-500/20">
                            <!-- Barra de progreso con color neón -->
                            <div class="bg-cyan-500 h-2.5 rounded-full shadow-[0_0_8px_rgba(0,255,255,0.7)]" style="width: ${progress}%"></div>
                        </div>
                    </div>

                    <!-- Contenedor de la Pregunta Actual: Sigue siendo claro para legibilidad -->
                    <div class="border-l-4 border-cyan-400 pl-6 bg-white p-6 rounded-lg shadow-xl shadow-cyan-500/10">
                        <span class="text-sm font-semibold text-cyan-600 uppercase tracking-wider">${currentCompetency}</span>
                         <h2 class="text-3xl font-bold font-title text-gray-800 mt-2 leading-snug">
                            ${question.text}
                        </h2>
                    </div>

                    <!-- Botones de Puntuación (Escala Likert) -->
                    <div class="mt-8 flex justify-center space-x-4">
                        <span class="text-gray-300 font-medium self-center w-24 text-right">1 (Bajo)</span>
                        ${buttonsHtml}
                        <span class="text-gray-300 font-medium self-center w-24 text-left">5 (Alto)</span>
                    </div>

                    <!-- Botones de Navegación -->
                    <div class="mt-10 flex justify-between">
                        <!-- Botón para ir a la pregunta anterior (fondo oscuro) -->
                        <button
                            onclick="prevQuestion()"
                            class="px-6 py-2 border border-gray-600 text-gray-300 font-semibold rounded-lg hover:bg-gray-700 transition duration-150 ${currentQuestionIndex === 0 ? 'opacity-50 cursor-not-allowed' : ''}"
                            ${currentQuestionIndex === 0 ? 'disabled' : ''}
                        >
                            ← Anterior
                        </button>
                        <!-- Botón para avanzar o ver resultados (color neón) -->
                        <button
                            onclick="nextQuestion()"
                            class="px-6 py-2 font-semibold rounded-lg transition duration-150 ${answers[currentQuestionIndex] === 0 
                                ? 'bg-gray-700 text-gray-400 cursor-not-allowed' 
                                : 'bg-cyan-500 text-gray-900 shadow-md shadow-cyan-500/50 hover:bg-cyan-400'}"
                            ${answers[currentQuestionIndex] === 0 ? 'disabled' : ''}
                        >
                            ${currentQuestionIndex === QUESTIONS.length - 1 ? 'Ver Resultados' : 'Siguiente →'}
                        </button>
                    </div>
                </div>
            `;
        }
        
        // --- LÓGICA DE NAVEGACIÓN Y RESPUESTA ---

        // Guarda la respuesta seleccionada en el array de respuestas
        function selectAnswer(score) {
            answers[currentQuestionIndex] = score;
            // Rerenderiza la pantalla para actualizar el estado del botón y la selección
            renderQuizScreen();
        }

        // Avanza a la siguiente pregunta si la actual ya fue respondida
        function nextQuestion() {
            if (answers[currentQuestionIndex] !== 0) {
                currentQuestionIndex++;
                renderQuizScreen();
            }
        }

        // Regresa a la pregunta anterior
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuizScreen();
            }
        }

        // ======================================================================
        // --- LÓGICA DE RESULTADOS Y RECOMENDACIONES ---
        // ======================================================================

        // Calcula el puntaje promedio para cada competencia
        function calculateResults() {
            const results = {};
            // Inicializa los contadores para cada competencia
            COMPETENCIES.forEach(c => results[c.id] = { totalScore: 0, count: 0, average: 0 });

            // Suma los puntajes por categoría
            QUESTIONS.forEach((q, index) => {
                const score = answers[index];
                if (score > 0) {
                    results[q.category].totalScore += score;
                    results[q.category].count++;
                }
            });

            // Calcula el promedio final (totalScore / count)
            COMPETENCIES.forEach(c => {
                const res = results[c.id];
                res.average = res.count > 0 ? (res.totalScore / res.count) : 0;
            });

            return results;
        }

        // Proporciona una recomendación de crecimiento basada en el puntaje promedio
        function getRecommendation(competencyId, score) {
            const lowScore = 3.0; // Puntaje bajo (necesita enfoque)
            const medScore = 4.0; // Puntaje medio (buen nivel, enfocar en excelencia)

            const recs = {
                comunicacion: {
                    low: 'Tus ideas son valiosas, pero necesitan pulirse en la entrega. Enfoque: Practica la técnica "Mensaje, Detalle, Cierre" (MDC) para ser más conciso. Haz un esfuerzo consciente por escuchar el 80% del tiempo y hablar el 20%.',
                    med: 'Tienes una buena base comunicativa. Para ser excelente: Pide retroalimentación específica sobre la claridad de tus correos y presentaciones. Explora herramientas de visualización de datos.',
                    high: '¡Excelente! Eres un comunicador claro. Tu siguiente paso es el Liderazgo Comunicativo: ayuda a otros a pulir sus mensajes y sé mentor en técnicas de escucha activa.'
                },
                problemas: {
                    low: 'Tiendes a abordar los síntomas en lugar de las causas. Enfoque: Siempre comienza preguntando "¿Por qué?" cinco veces (Técnica de los 5 Porqués). Documenta los pasos de tus soluciones para aprender de los fracasos.',
                    med: 'Eres bueno resolviendo problemas, pero puedes acelerar el proceso. Para ser excelente: Dedica 15 minutos semanales a ejercicios de pensamiento lateral y busca la perspectiva de compañeros de otras áreas.',
                    high: '¡Impresionante! Eres un resolvedor nato. Tu siguiente paso es la Gestión de Crisis: Lidera un pequeño proyecto simulado de alta incertidumbre y estandariza tus mejores métodos de análisis.'
                },
                tiempo: {
                    low: 'Sientes que el tiempo te controla. Enfoque: Implementa la Matriz de Eisenhower (Urge/Importante) para priorizar. Intenta la técnica Pomodoro (25 minutos de trabajo enfocado, 5 de descanso) para mejorar la concentración.',
                    med: 'Manejas tu tiempo de forma adecuada. Para ser excelente: Delega tareas menores cuando sea posible. Al final del día, define las 3 tareas "Top" que SÍ o SÍ debes completar mañana.',
                    high: '¡Dominas tu agenda! Eres un modelo de productividad. Tu siguiente paso es la Eficiencia Sistémica: Ayuda al equipo a identificar y eliminar cuellos de botella en los procesos grupales.'
                },
                liderazgo: {
                    low: 'A menudo esperas instrucciones claras antes de actuar. Enfoque: Identifica un área pequeña de tu trabajo que te moleste y propón una mejora proactivamente, sin esperar permiso. Céntrate en terminar lo que empiezas.',
                    med: 'Muestras iniciativa en ocasiones. Para ser excelente: Asume la propiedad total de un proyecto desde la A hasta la Z, incluso si fracasa. Ofrece ayuda a tus compañeros sin esperar algo a cambio.',
                    high: '¡Eres un líder en acción! Tu energía impulsa al equipo. Tu siguiente paso es la Visión Estratégica: Piensa no solo en el "qué" sino en el "por qué" y el "hacia dónde" del equipo en los próximos 6 meses.'
                }
            };

            // Determina la recomendación según el rango de puntaje
            let recommendation;
            if (score < lowScore) {
                recommendation = { text: recs[competencyId].low, tone: 'text-red-600' };
            } else if (score < medScore) {
                recommendation = { text: recs[competencyId].med, tone: 'text-yellow-600' };
            } else {
                recommendation = { text: recs[competencyId].high, tone: 'text-green-600' };
            }
            return recommendation;
        }

        // Función para manejar el envío simulado de retroalimentación
        function submitFeedback() {
            const textarea = document.getElementById('feedbackTextarea');
            const message = document.getElementById('feedbackMessage');
            const button = document.getElementById('submitFeedbackBtn');
            const feedbackText = textarea.value.trim();

            if (feedbackText.length < 5) {
                // Validación simple para que no envíen comentarios vacíos
                message.textContent = 'Por favor, escribe un comentario más detallado (mínimo 5 caracteres).';
                message.classList.remove('text-green-600', 'opacity-0');
                message.classList.add('text-red-600', 'opacity-100');
                setTimeout(() => {
                    message.classList.remove('opacity-100');
                    message.classList.add('opacity-0');
                }, 4000);
                return;
            }

            // Simulación de envío (En un entorno real, aquí se usaría Firestore/API)
            console.log("Comentario Enviado:", feedbackText);

            // Muestra mensaje de éxito
            message.textContent = '¡Gracias! Tu retroalimentación ha sido registrada.';
            message.classList.remove('text-red-600', 'opacity-0');
            message.classList.add('text-green-600', 'opacity-100');
            
            // Deshabilita la interfaz
            textarea.disabled = true;
            button.disabled = true;
            button.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
            button.classList.add('bg-gray-400', 'cursor-not-allowed');

            // Ocultar el mensaje después de 5 segundos
            setTimeout(() => {
                message.classList.remove('opacity-100');
                message.classList.add('opacity-0');
            }, 5000);
        }

        // RENDERIZA la pantalla final de resultados
        function renderResultsScreen() {
            const results = calculateResults();
            const labels = COMPETENCIES.map(c => c.name);
            const data = COMPETENCIES.map(c => results[c.id].average);
            const backgroundColors = COMPETENCIES.map(c => c.color);
            const borderColors = COMPETENCIES.map(c => c.borderColor);

            // Generar el bloque HTML con las recomendaciones para cada competencia
            const recommendationsHtml = COMPETENCIES.map(c => {
                const avg = data[COMPETENCIES.findIndex(comp => comp.id === c.id)];
                const rec = getRecommendation(c.id, avg);
                const scoreText = avg.toFixed(1);
                // Clases dinámicas para colorear el puntaje según el nivel
                const scoreClass = avg < 3 ? 'bg-red-500 text-white' : (avg < 4 ? 'bg-yellow-500 text-gray-900' : 'bg-green-500 text-white');

                return `
                    <!-- Los bloques de recomendación son claros, pero con borde sutil para destacar -->
                    <div class="p-5 border border-gray-700 rounded-xl shadow-lg hover:shadow-cyan-500/10 transition duration-200 bg-gray-800">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-xl font-bold font-title text-white">${c.name}</h3>
                            <span class="px-3 py-1 ${scoreClass} text-sm font-semibold rounded-full">${scoreText} / 5</span>
                        </div>
                        <p class="text-gray-300">${rec.text}</p>
                    </div>
                `;
            }).join('');

            appContainer.innerHTML = `
                <!-- Aplicando la clase 'vibrant-game-bg' para el fondo llamativo -->
                <div class="p-4 md:p-8 h-full rounded-2xl vibrant-game-bg">
                    <!-- Títulos en cian neón para alto contraste -->
                    <h1 class="text-4xl font-extrabold font-title text-cyan-400 text-center mb-3 drop-shadow-[0_0_5px_rgba(0,255,255,0.7)]">
                        Análisis de Perfil para GamesCow
                    </h1>
                    <p class="text-xl text-gray-300 text-center mb-10">
                        Explora tu desempeño en cada área y descubre tu camino de crecimiento.
                    </p>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
                        <!-- Contenedor del Gráfico de Radar: Fondo oscuro para mantener el tema -->
                        <div class="lg:col-span-1 bg-gray-900 p-6 rounded-xl shadow-2xl shadow-cyan-500/20 flex justify-center items-center border border-cyan-500/30">
                            <canvas id="radarChart" class="max-h-[350px]"></canvas>
                        </div>

                        <!-- Mensaje de Motivación: Bloque de alto contraste -->
                        <div class="lg:col-span-2 p-8 bg-indigo-900 border-l-4 border-cyan-400 rounded-xl flex flex-col justify-center shadow-2xl shadow-cyan-500/20">
                            <h2 class="text-3xl font-bold font-title text-cyan-400 mb-4">
                                ¡Celebra tus Fortalezas!
                            </h2>
                            <p class="text-gray-200 text-lg">
                                Tienes un perfil único y valioso. Recuerda que la verdadera fortaleza de un equipo reside en la **diversidad de habilidades**. Utiliza este perfil para saber dónde brillas y qué áreas puedes desarrollar. ¡El crecimiento es un trabajo en equipo! Habla con tus compañeros sobre estos resultados para identificar sinergias.
                            </p>
                        </div>
                    </div>

                    <!-- Sección de Recomendaciones -->
                    <h2 class="text-3xl font-bold font-title text-white mb-6 border-b border-gray-700 pb-2">
                        Recomendaciones Personalizadas (Puntaje Promedio / 5)
                    </h2>
                    <div class="space-y-6">
                        ${recommendationsHtml}
                    </div>

                    <!-- Sección de Retroalimentación de Empleados (Fondo oscuro, elementos claros) -->
                    <div class="mt-12 p-8 bg-gray-900 border border-gray-700 rounded-xl shadow-2xl shadow-indigo-500/10">
                        <h2 class="text-3xl font-bold font-title text-white mb-4 border-b border-gray-700 pb-2">
                            Comentarios y Retroalimentación
                        </h2>
                        <p class="text-gray-400 mb-4">
                            Tu perspectiva es vital. Por favor, usa este espacio para compartir tus comentarios generales sobre la evaluación o sugerencias de mejora.
                        </p>

                        <textarea
                            id="feedbackTextarea"
                            rows="4"
                            class="w-full p-4 border border-gray-700 bg-gray-800 text-white rounded-lg focus:ring-cyan-500 focus:border-cyan-500 transition duration-150 resize-none"
                            placeholder="Escribe tu retroalimentación aquí..."
                        ></textarea>

                        <div class="mt-4 text-right">
                            <button
                                id="submitFeedbackBtn"
                                onclick="submitFeedback()"
                                class="px-6 py-3 bg-cyan-500 text-gray-900 font-semibold rounded-full shadow-lg shadow-cyan-500/50 hover:bg-cyan-400 transition duration-300"
                            >
                                Enviar Comentario
                            </button>
                            <p id="feedbackMessage" class="mt-2 text-sm font-medium text-green-400 opacity-0 transition duration-500">
                                <!-- Mensaje de confirmación se insertará aquí -->
                            </p>
                        </div>
                    </div>

                    <!-- Botón para reiniciar la evaluación -->
                    <div class="mt-12 text-center">
                        <button
                            onclick="renderWelcomeScreen()"
                            class="px-6 py-2 bg-gray-700 text-gray-100 font-semibold rounded-full hover:bg-gray-600 transition duration-150"
                        >
                            Reiniciar Autoevaluación
                        </button>
                    </div>
                </div>
            `;
            // Llama a la función para dibujar el gráfico después de que el HTML está listo
            setTimeout(() => drawRadarChart(labels, data, backgroundColors, borderColors), 100);
        }

        // Dibuja el gráfico de radar con Chart.js
        function drawRadarChart(labels, data, backgroundColors, borderColors) {
            const ctx = document.getElementById('radarChart');

            // Destruye cualquier instancia anterior del gráfico para evitar duplicados
            if (window.radarChartInstance) {
                window.radarChartInstance.destroy(); 
            }

            // Crea la nueva instancia del gráfico de radar
            window.radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels, // Nombres de las competencias
                    datasets: [{
                        label: 'Mi Perfil de Competencias (1-5)',
                        data: data, // Puntajes promedio
                        backgroundColor: backgroundColors[0].replace('0.8', '0.4'), // Relleno con transparencia
                        borderColor: borderColors[0], // Color de la línea
                        borderWidth: 2,
                        pointBackgroundColor: borderColors,
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: borderColors
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // Permite ajustar el tamaño para móvil
                    plugins: {
                        legend: {
                            display: false, // Oculta la leyenda
                        },
                        tooltip: {
                            // Configuración de la información que se muestra al pasar el mouse
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.r.toFixed(1)} / 5`;
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.2)' }, /* Líneas de ángulo más claras */
                            grid: { color: 'rgba(255, 255, 255, 0.2)' }, /* Líneas de la cuadrícula más claras */
                            pointLabels: {
                                font: { size: 14, weight: 'bold' },
                                color: '#a0aec0' /* Color de etiqueta claro */
                            },
                            suggestedMin: 1, // Escala comienza en 1
                            suggestedMax: 5, // Escala termina en 5
                            ticks: {
                                stepSize: 1,
                                backdropColor: 'rgba(14, 20, 40, 0.8)', /* Fondo de ticks oscuro */
                                color: '#a0aec0'
                            }
                        }
                    }
                }
            });
        }

        // ======================================================================
        // --- INICIALIZACIÓN DE LA APLICACIÓN ---
        // ======================================================================

        // Se ejecuta una vez que el DOM está completamente cargado
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Iniciar el reloj y programar la actualización cada segundo
            updateClock();
            setInterval(updateClock, 1000);

            // 2. Iniciar la aplicación en la pantalla de bienvenida
            renderWelcomeScreen();
        });
    </script>
</body>
</html>


